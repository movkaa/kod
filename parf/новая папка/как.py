import numpy as np
import matplotlib.pyplot as plt

print("–£–ß–ò–ú –ù–ï–ô–†–û–°–ï–¢–¨ –°–û–†–¢–ò–†–û–í–ê–¢–¨ –ß–ò–°–õ–ê")
print("=" * 50)

—á–∏—Å–ª–∞ = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ_–æ—Ç–≤–µ—Ç—ã = np.array([1, 1, 1, 1, 1, 0, 0, 0,
0, 0])
print(f"–ù–∞—à–∏ —á–∏—Å–ª–∞: {—á–∏—Å–ª–∞}")
print(f"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã (1=–º–∞–ª–µ–Ω—å–∫–æ–µ, 0=–±–æ–ª—å—à–æ–µ):{–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ_–æ—Ç–≤–µ—Ç—ã}")
print()
np.random.seed(42)
w1 = np.random.randn()
w2 = np.random.randn()
b = np.random.randn()
print("–ù–ê–ß–ê–õ–¨–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ –ù–ï–ô–†–û–°–ï–¢–ò:")
print(f" w1 = {w1:.3f}")
print(f" w2 = {w2:.3f}")
print(f" b = {b:.3f}")
print()
—Å–∫–æ—Ä–æ—Å—Ç—å_–æ–±—É—á–µ–Ω–∏—è = 0.4
—ç–ø–æ—Ö = 500
–∏—Å—Ç–æ—Ä–∏—è_–æ—à–∏–±–æ–∫ = []
–≤—Å–µ_–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è = []
def —Å–∏–≥–º–æ–∏–¥–∞(x):
    return 1 / (1 + np.exp(-x))
print("–ù–ê–ß–ò–ù–ê–ï–ú –û–ë–£–ß–ï–ù–ò–ï...")
print("-" * 30)
for —ç–ø–æ—Ö–∞ in range(—ç–ø–æ—Ö):
    # 6.1. –ü—Ä—è–º–æ–π –ø—Ä–æ—Ö–æ–¥ (—Ä–æ–±–æ—Ç —É–≥–∞–¥—ã–≤–∞–µ—Ç)
    z = w1 * —á–∏—Å–ª–∞ + w2 * (—á–∏—Å–ª–∞ ** 2) + b
    –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è = —Å–∏–≥–º–æ–∏–¥–∞(z)
    # 6.2. –°—á–∏—Ç–∞–µ–º –æ—à–∏–±–∫—É
    –æ—à–∏–±–∫–∞ = –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ_–æ—Ç–≤–µ—Ç—ã
    loss = np.mean(–æ—à–∏–±–∫–∞ ** 2)
    –∏—Å—Ç–æ—Ä–∏—è_–æ—à–∏–±–æ–∫.append(loss)
    –≤—Å–µ_–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.append(–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.copy())
    # 6.3. –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ö–æ–¥ (–∏—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—à–∏–±–∫–∏)
    d_pred = –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è * (1 - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è) # –ü—Ä–æ–∏–∑–≤–æ–¥–Ω–∞—è —Å–∏–≥–º–æ–∏–¥—ã
    grad_w1 = np.mean(2 * –æ—à–∏–±–∫–∞ * d_pred * —á–∏—Å–ª–∞)
    grad_w2 = np.mean(2 * –æ—à–∏–±–∫–∞ * d_pred * (—á–∏—Å–ª–∞ **
    2))
    grad_b = np.mean(2 * –æ—à–∏–±–∫–∞ * d_pred)
    # 6.4. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    w1 -= —Å–∫–æ—Ä–æ—Å—Ç—å_–æ–±—É—á–µ–Ω–∏—è * grad_w1
    w2 -= —Å–∫–æ—Ä–æ—Å—Ç—å_–æ–±—É—á–µ–Ω–∏—è * grad_w2
    b -= —Å–∫–æ—Ä–æ—Å—Ç—å_–æ–±—É—á–µ–Ω–∏—è * grad_b
    # 6.5. –í—ã–≤–æ–¥–∏–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    if —ç–ø–æ—Ö–∞ % 10 == 0 or —ç–ø–æ—Ö–∞ < 5:
        —Ç–æ—á–Ω–æ—Å—Ç—å = np.mean((–ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è > 0.5) == –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ_–æ—Ç–≤–µ—Ç—ã) * 100
    print(f"–≠–ø–æ—Ö–∞ {—ç–ø–æ—Ö–∞:2d}: –û—à–∏–±–∫–∞ = {loss:.4f},–¢–æ—á–Ω–æ—Å—Ç—å = {—Ç–æ—á–Ω–æ—Å—Ç—å:.1f}%")

print("\n–û–ë–£–ß–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û!")
print(f"–§–∏–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: w1={w1:.3f}, w2={w2:.3f},b={b:.3f}")
print("\n" + "=" * 50)
print("–¢–ï–°–¢–ò–†–£–ï–ú –ù–ê –ù–û–í–´–• –ß–ò–°–õ–ê–•")
print("=" * 50)
–Ω–æ–≤—ã–µ_—á–∏—Å–ª–∞ = [2.5, 5.5, 7.8, 3.2, 9.1, 4.9]
print("–ß–∏—Å–ª–æ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å '–º–∞–ª–µ–Ω—å–∫–æ–µ' | –†–µ—à–µ–Ω–∏–µ —Å–µ—Ç–∏")
print("-" * 45)
for —á–∏—Å–ª–æ in –Ω–æ–≤—ã–µ_—á–∏—Å–ª–∞:
    z_—Ç–µ—Å—Ç = w1 * —á–∏—Å–ª–æ + w2 * (—á–∏—Å–ª–æ ** 2) + b
    –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å = —Å–∏–≥–º–æ–∏–¥–∞(z_—Ç–µ—Å—Ç)
    —Ä–µ—à–µ–Ω–∏–µ = "–ú–ê–õ–ï–ù–¨–ö–û–ï" if –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å > 0.5 else "–ë–û–õ–¨–®–û–ï"
    print(f"{—á–∏—Å–ª–æ:5.1f} | {–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:20.2%} | {—Ä–µ—à–µ–Ω–∏–µ}")
# 8. –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
print("\n" + "=" * 50)
print("–°–¢–†–û–ò–ú –ì–†–ê–§–ò–ö–ò –û–ë–£–ß–ï–ù–ò–Ø")
print("=" * 50)
fig, axes = plt.subplots(2, 2, figsize=(12, 10))
# –ì—Ä–∞—Ñ–∏–∫ 1: –ö–∞–∫ —É–º–µ–Ω—å—à–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞
axes[0, 0].plot(–∏—Å—Ç–æ—Ä–∏—è_–æ—à–∏–±–æ–∫, 'r-', linewidth=2)
axes[0, 0].set_xlabel('–ù–æ–º–µ—Ä —ç–ø–æ—Ö–∏')
axes[0, 0].set_ylabel('–û—à–∏–±–∫–∞ (–º–µ–Ω—å—à–µ = –ª—É—á—à–µ)')
axes[0, 0].set_title('–ö–∞–∫ —É–º–µ–Ω—å—à–∞–ª–∞—Å—å –æ—à–∏–±–∫–∞')
axes[0, 0].grid(True, alpha=0.3)
axes[0, 0].set_ylim([0, max(–∏—Å—Ç–æ—Ä–∏—è_–æ—à–∏–±–æ–∫[0], 0.5)])
# –ì—Ä–∞—Ñ–∏–∫ 2: –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
x_—Ç–µ—Å—Ç = np.linspace(1, 10, 100)
z_—Ç–µ—Å—Ç = w1 * x_—Ç–µ—Å—Ç + w2 * (x_—Ç–µ—Å—Ç ** 2) + b
y_—Ç–µ—Å—Ç = —Å–∏–≥–º–æ–∏–¥–∞(z_—Ç–µ—Å—Ç)
axes[0, 1].plot(x_—Ç–µ—Å—Ç, y_—Ç–µ—Å—Ç, 'b-', linewidth=3,
label='–†–µ—à–µ–Ω–∏–µ —Å–µ—Ç–∏')
axes[0, 1].scatter(—á–∏—Å–ª–∞, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ_–æ—Ç–≤–µ—Ç—ã, color='red', s=100,
label='–¢–æ—á–∫–∏ –æ–±—É—á–µ–Ω–∏—è', zorder=5)
axes[0, 1].axhline(y=0.5, color='green', linestyle='--',
alpha=0.5, label='–ì—Ä–∞–Ω–∏—Ü–∞ 0.5')
axes[0, 1].set_xlabel('–ß–∏—Å–ª–æ')
axes[0, 1].set_ylabel('–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å "–º–∞–ª–µ–Ω—å–∫–æ–µ"')
axes[0, 1].set_title('–ß—Ç–æ –Ω–∞—É—á–∏–ª–∞—Å—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —Å–µ—Ç—å')
axes[0, 1].legend()
axes[0, 1].grid(True, alpha=0.3)
plt.suptitle('–ù–ï–ô–†–û–°–ï–¢–¨-–°–û–†–¢–ò–†–û–í–©–ò–ö: –†–ï–ó–£–õ–¨–¢–ê–¢–´ –û–ë–£–ß–ï–ù–ò–Ø',
fontsize=14, fontweight='bold')
plt.tight_layout()
plt.show()
# 9. –ò–ì–†–ê–ï–ú –° –ù–ï–ô–†–û–°–ï–¢–¨–Æ
print("\n" + "=" * 50)
print("üéÆ –ò–ì–†–ê–ï–ú –° –ù–ï–ô–†–û–°–ï–¢–¨–Æ")
print("=" * 50)
while True:
    try:
        –≤–≤–æ–¥ = input("\n–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ (–æ—Ç 1 –¥–æ 10) –∏–ª–∏ '—Å—Ç–æ–ø': ")
        if –≤–≤–æ–¥.lower() in ['—Å—Ç–æ–ø', 'stop', '–≤—ã—Ö–æ–¥', 'exit']:
            print("üëã –î–æ —Å–≤–∏–¥–∞–Ω–∏—è!")
            break
        —á–∏—Å–ª–æ = float(–≤–≤–æ–¥)
        if —á–∏—Å–ª–æ < 1 or —á–∏—Å–ª–æ > 10:
            print("‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10")
            continue
        z = w1 * —á–∏—Å–ª–æ + w2 * (—á–∏—Å–ª–æ ** 2) + b
        –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å = —Å–∏–≥–º–æ–∏–¥–∞(z)
        print(f"\nüîç –ê–Ω–∞–ª–∏–∑ —á–∏—Å–ª–∞ {—á–∏—Å–ª–æ}:")
        print(f" –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ —á–∏—Å–ª–æ –ú–ê–õ–ï–ù–¨–ö–û–ï: {–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:.1%}")
        print(f" –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ —á–∏—Å–ª–æ –ë–û–õ–¨–®–û–ï: {1-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:.1%}")
        —Ä–µ—à–µ–Ω–∏–µ = "–ú–ê–õ–ï–ù–¨–ö–û–ï" if –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å > 0.5 else "–ë–û–õ–¨–®–û–ï"
        print(f" üìè –†–µ—à–µ–Ω–∏–µ —Å–µ—Ç–∏: {—Ä–µ—à–µ–Ω–∏–µ} (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å {max(–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, 1-–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å):.0%})")
        if (—á–∏—Å–ª–æ < 5.5 and –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å > 0.5) or (—á–∏—Å–ª–æ >= 5.5 and –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å <= 0.5):
            print(" ‚úÖ –°–µ—Ç—å –ø—Ä–∞–≤–∞!")
        else:
            print(" ‚ùå –°–µ—Ç—å –æ—à–∏–±–ª–∞—Å—å!")
    except ValueError:
        print("‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ")
